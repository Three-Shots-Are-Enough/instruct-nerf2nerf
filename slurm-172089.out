[2024-11-11 11:51:15] Starting nerfacto training...
[11:51:59] Using --data alias for --data.pipeline.datamanager.data                                          train.py:230
──────────────────────────────────────────────────────── Config ────────────────────────────────────────────────────────
TrainerConfig(
    _target=<class 'nerfstudio.engine.trainer.Trainer'>,
    output_dir=PosixPath('outputs'),
    method_name='nerfacto',
    experiment_name=None,
    project_name='nerfstudio-project',
    timestamp='2024-11-11_115159',
    machine=MachineConfig(seed=42, num_devices=1, num_machines=1, machine_rank=0, dist_url='auto', device_type='cuda'),
    logging=LoggingConfig(
        relative_log_dir=PosixPath('.'),
        steps_per_log=1000,
        max_buffer_size=20,
        local_writer=LocalWriterConfig(
            _target=<class 'nerfstudio.utils.writer.LocalWriter'>,
            enable=True,
            stats_to_track=(
                <EventName.ITER_TRAIN_TIME: 'Train Iter (time)'>,
                <EventName.TRAIN_RAYS_PER_SEC: 'Train Rays / Sec'>,
                <EventName.CURR_TEST_PSNR: 'Test PSNR'>,
                <EventName.VIS_RAYS_PER_SEC: 'Vis Rays / Sec'>,
                <EventName.TEST_RAYS_PER_SEC: 'Test Rays / Sec'>,
                <EventName.ETA: 'ETA (time)'>
            ),
            max_log_size=10
        ),
        profiler='basic'
    ),
    viewer=ViewerConfig(
        relative_log_filename='viewer_log_filename.txt',
        websocket_port=None,
        websocket_port_default=7007,
        websocket_host='0.0.0.0',
        num_rays_per_chunk=32768,
        max_num_display_images=512,
        quit_on_train_completion=False,
        image_format='jpeg',
        jpeg_quality=75,
        make_share_url=False,
        camera_frustum_scale=0.1,
        default_composite_depth=True
    ),
    pipeline=VanillaPipelineConfig(
        _target=<class 'nerfstudio.pipelines.base_pipeline.VanillaPipeline'>,
        datamanager=ParallelDataManagerConfig(
            _target=<class 'nerfstudio.data.datamanagers.parallel_datamanager.ParallelDataManager'>,
            data=PosixPath('datasets/bear'),
            masks_on_gpu=False,
            images_on_gpu=False,
            dataparser=NerfstudioDataParserConfig(
                _target=<class 'nerfstudio.data.dataparsers.nerfstudio_dataparser.Nerfstudio'>,
                data=PosixPath('.'),
                scale_factor=1.0,
                downscale_factor=None,
                scene_scale=1.0,
                orientation_method='up',
                center_method='poses',
                auto_scale_poses=True,
                eval_mode='fraction',
                train_split_fraction=0.9,
                eval_interval=8,
                depth_unit_scale_factor=0.001,
                mask_color=None,
                load_3D_points=False
            ),
            train_num_rays_per_batch=4096,
            train_num_images_to_sample_from=-1,
            train_num_times_to_repeat_images=-1,
            eval_num_rays_per_batch=4096,
            eval_num_images_to_sample_from=-1,
            eval_num_times_to_repeat_images=-1,
            eval_image_indices=(0,),
            collate_fn=<function nerfstudio_collate at 0x7fcb23490f70>,
            camera_res_scale_factor=1.0,
            patch_size=1,
            camera_optimizer=None,
            pixel_sampler=PixelSamplerConfig(
                _target=<class 'nerfstudio.data.pixel_samplers.PixelSampler'>,
                num_rays_per_batch=4096,
                keep_full_image=False,
                is_equirectangular=False,
                ignore_mask=False,
                fisheye_crop_radius=None,
                rejection_sample_mask=True,
                max_num_iterations=100
            ),
            num_processes=1,
            queue_size=2,
            max_thread_workers=None
        ),
        model=NerfactoModelConfig(
            _target=<class 'nerfstudio.models.nerfacto.NerfactoModel'>,
            enable_collider=True,
            collider_params={'near_plane': 2.0, 'far_plane': 6.0},
            loss_coefficients={'rgb_loss_coarse': 1.0, 'rgb_loss_fine': 1.0},
            eval_num_rays_per_chunk=32768,
            prompt=None,
            near_plane=0.05,
            far_plane=1000.0,
            background_color='last_sample',
            hidden_dim=64,
            hidden_dim_color=64,
            hidden_dim_transient=64,
            num_levels=16,
            base_res=16,
            max_res=2048,
            log2_hashmap_size=19,
            features_per_level=2,
            num_proposal_samples_per_ray=(256, 96),
            num_nerf_samples_per_ray=48,
            proposal_update_every=5,
            proposal_warmup=5000,
            num_proposal_iterations=2,
            use_same_proposal_network=False,
            proposal_net_args_list=[
                {'hidden_dim': 16, 'log2_hashmap_size': 17, 'num_levels': 5, 'max_res': 128, 'use_linear': False},
                {'hidden_dim': 16, 'log2_hashmap_size': 17, 'num_levels': 5, 'max_res': 256, 'use_linear': False}
            ],
            proposal_initial_sampler='piecewise',
            interlevel_loss_mult=1.0,
            distortion_loss_mult=0.002,
            orientation_loss_mult=0.0001,
            pred_normal_loss_mult=0.001,
            use_proposal_weight_anneal=True,
            use_appearance_embedding=True,
            use_average_appearance_embedding=True,
            proposal_weights_anneal_slope=10.0,
            proposal_weights_anneal_max_num_iters=1000,
            use_single_jitter=True,
            predict_normals=False,
            disable_scene_contraction=False,
            use_gradient_scaling=False,
            implementation='tcnn',
            appearance_embed_dim=32,
            average_init_density=0.01,
            camera_optimizer=CameraOptimizerConfig(
                _target=<class 'nerfstudio.cameras.camera_optimizers.CameraOptimizer'>,
                mode='SO3xR3',
                trans_l2_penalty=0.01,
                rot_l2_penalty=0.001,
                optimizer=None,
                scheduler=None
            )
        )
    ),
    optimizers={
        'proposal_networks': {
            'optimizer': AdamOptimizerConfig(
                _target=<class 'torch.optim.adam.Adam'>,
                lr=0.01,
                eps=1e-15,
                max_norm=None,
                weight_decay=0
            ),
            'scheduler': ExponentialDecaySchedulerConfig(
                _target=<class 'nerfstudio.engine.schedulers.ExponentialDecayScheduler'>,
                lr_pre_warmup=1e-08,
                lr_final=0.0001,
                warmup_steps=0,
                max_steps=200000,
                ramp='cosine'
            )
        },
        'fields': {
            'optimizer': AdamOptimizerConfig(
                _target=<class 'torch.optim.adam.Adam'>,
                lr=0.01,
                eps=1e-15,
                max_norm=None,
                weight_decay=0
            ),
            'scheduler': ExponentialDecaySchedulerConfig(
                _target=<class 'nerfstudio.engine.schedulers.ExponentialDecayScheduler'>,
                lr_pre_warmup=1e-08,
                lr_final=0.0001,
                warmup_steps=0,
                max_steps=200000,
                ramp='cosine'
            )
        },
        'camera_opt': {
            'optimizer': AdamOptimizerConfig(
                _target=<class 'torch.optim.adam.Adam'>,
                lr=0.001,
                eps=1e-15,
                max_norm=None,
                weight_decay=0
            ),
            'scheduler': ExponentialDecaySchedulerConfig(
                _target=<class 'nerfstudio.engine.schedulers.ExponentialDecayScheduler'>,
                lr_pre_warmup=1e-08,
                lr_final=0.0001,
                warmup_steps=0,
                max_steps=5000,
                ramp='cosine'
            )
        }
    },
    vis='tensorboard',
    data=PosixPath('datasets/bear'),
    prompt=None,
    relative_model_dir=PosixPath('nerfstudio_models'),
    load_scheduler=True,
    steps_per_save=2000,
    steps_per_eval_batch=500,
    steps_per_eval_image=500,
    steps_per_eval_all_images=25000,
    max_num_iterations=30000,
    mixed_precision=True,
    use_grad_scaler=False,
    save_only_latest_checkpoint=True,
    load_dir=None,
    load_step=None,
    load_config=None,
    load_checkpoint=None,
    log_gradients=False,
    gradient_accumulation_steps={}
)
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
           Saving config to: outputs/bear/nerfacto/2024-11-11_115159/config.yml                 experiment_config.py:136
           Saving checkpoints to: outputs/bear/nerfacto/2024-11-11_115159/nerfstudio_models               trainer.py:138
           Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/tinycudann/modules.py:57: UserWarning: tinycudann was built for lower compute capability (61) than the system's (86). Performance may be suboptimal.
  warnings.warn(f"tinycudann was built for lower compute capability ({cc}) than the system's ({system_compute_capability}). Performance may be suboptimal.")
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/nerfstudio/field_components/activations.py:32: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  @custom_fwd(cast_inputs=torch.float32)
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/nerfstudio/field_components/activations.py:39: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, g):
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/nerfstudio/engine/trainer.py:133: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.grad_scaler = GradScaler(enabled=self.use_grad_scaler)
Started threads
Setting up evaluation dataset...
Caching all 9 images.

Loading data batch ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
No Nerfstudio checkpoint to load, so training from scratch.
logging events to: outputs/bear/nerfacto/2024-11-11_115159
[11:52:07] Printing max of 10 lines. Set flag --logging.local-writer.max-log-size=0 to disable line        writer.py:449
           wrapping.                                                                                                    
Step (% Done)       Train Iter (time)    ETA (time)           
--------------------------------------------------------------
[2A[1KStep (% Done)       Train Iter (time)    ETA (time)            [0m
-------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s       [0m
[3A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
[4A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
[5A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
[6A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
[7A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
[8A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
[9A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
[10A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
[11A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
0 (0.00%)           516.376 ms           4 h, 18 m, 11 s                                                 [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
1000 (3.33%)        66.051 ms            31 m, 55 s           82.35 K              325.44 K              [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
2000 (6.67%)        123.132 ms           57 m, 27 s           62.87 K              333.15 K              [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
3000 (10.00%)       56.634 ms            25 m, 29 s           99.49 K              334.04 K              [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
4000 (13.33%)       46.701 ms            20 m, 14 s           106.09 K             334.92 K              [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
5000 (16.67%)       37.016 ms            15 m, 25 s           115.28 K             328.77 K              [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
6000 (20.00%)       38.165 ms            15 m, 15 s           114.22 K             330.28 K              [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
7000 (23.33%)       35.157 ms            13 m, 28 s           120.49 K             331.55 K              [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
8000 (26.67%)       42.698 ms            15 m, 39 s           109.23 K             332.51 K              [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
9000 (30.00%)       43.785 ms            15 m, 19 s           111.60 K             333.14 K              [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
10000 (33.33%)      33.665 ms            11 m, 13 s           125.24 K             333.90 K              [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
11000 (36.67%)      36.734 ms            11 m, 37 s           118.97 K             334.94 K              [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
12000 (40.00%)      100.285 ms           30 m, 5 s            76.99 K              334.48 K              [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
13000 (43.33%)      33.049 ms            9 m, 21 s            128.47 K             334.59 K              [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
14000 (46.67%)      71.912 ms            19 m, 10 s           98.00 K              334.39 K              [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
15000 (50.00%)      34.957 ms            8 m, 44 s            121.70 K             337.76 K              [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m

[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
16000 (53.33%)      60.471 ms            14 m, 6 s            104.82 K             337.51 K              [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m
25000 (83.33%)      95.394 ms            7 m, 56 s            81.34 K              339.41 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
17000 (56.67%)      57.843 ms            12 m, 31 s           101.70 K             337.69 K              [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m
25000 (83.33%)      95.394 ms            7 m, 56 s            81.34 K              339.41 K              [0m
26000 (86.67%)      39.557 ms            2 m, 38 s            110.24 K             339.75 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
18000 (60.00%)      53.279 ms            10 m, 39 s           107.07 K             338.31 K              [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m
25000 (83.33%)      95.394 ms            7 m, 56 s            81.34 K              339.41 K              [0m
26000 (86.67%)      39.557 ms            2 m, 38 s            110.24 K             339.75 K              [0m
27000 (90.00%)      53.141 ms            2 m, 39 s            107.75 K             339.18 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
19000 (63.33%)      43.130 ms            7 m, 54 s            120.03 K             338.25 K              [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m
25000 (83.33%)      95.394 ms            7 m, 56 s            81.34 K              339.41 K              [0m
26000 (86.67%)      39.557 ms            2 m, 38 s            110.24 K             339.75 K              [0m
27000 (90.00%)      53.141 ms            2 m, 39 s            107.75 K             339.18 K              [0m
28000 (93.33%)      39.928 ms            1 m, 19 s            113.44 K             338.37 K              [0m
[12A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
20000 (66.67%)      34.394 ms            5 m, 43 s            123.47 K             337.90 K              [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m
25000 (83.33%)      95.394 ms            7 m, 56 s            81.34 K              339.41 K              [0m
26000 (86.67%)      39.557 ms            2 m, 38 s            110.24 K             339.75 K              [0m
27000 (90.00%)      53.141 ms            2 m, 39 s            107.75 K             339.18 K              [0m
28000 (93.33%)      39.928 ms            1 m, 19 s            113.44 K             338.37 K              [0m
29000 (96.67%)      37.142 ms            37 s, 141.657 ms     114.76 K             338.43 K              [0m
[12A[1KStep (% Done)                                                                                            [0m
--------------------                                                                                     [0m
21000 (70.00%)      58.922 ms            8 m, 50 s            103.36 K             338.07 K              [0m
22000 (73.33%)      64.601 ms            8 m, 36 s            99.55 K              338.20 K              [0m
23000 (76.67%)      78.136 ms            9 m, 6 s             90.27 K              338.53 K              [0m
24000 (80.00%)      47.482 ms            4 m, 44 s            106.63 K             339.22 K              [0m
25000 (83.33%)      95.394 ms            7 m, 56 s            81.34 K              339.41 K              [0m
26000 (86.67%)      39.557 ms            2 m, 38 s            110.24 K             339.75 K              [0m
27000 (90.00%)      53.141 ms            2 m, 39 s            107.75 K             339.18 K              [0m
28000 (93.33%)      39.928 ms            1 m, 19 s            113.44 K             338.37 K              [0m
29000 (96.67%)      37.142 ms            37 s, 141.657 ms     114.76 K             338.43 K              [0m
29999 (100.00%)                                                                                          [0m
╭────────────────────────────── 🎉 Training Finished 🎉 ───────────────────────────────╮
│                        ╷                                                             │
│   Config File          │ outputs/bear/nerfacto/2024-11-11_115159/config.yml          │
│   Checkpoint Directory │ outputs/bear/nerfacto/2024-11-11_115159/nerfstudio_models   │
│                        ╵                                                             │
╰──────────────────────────────────────────────────────────────────────────────────────╯
Printing profiling stats, from longest to shortest duration in seconds
VanillaPipeline.get_average_eval_image_metrics: 19.2131             
VanillaPipeline.get_average_image_metrics: 19.2130             
VanillaPipeline.get_eval_image_metrics_and_images: 2.1808              
Trainer.train_iteration: 0.0564              
VanillaPipeline.get_train_loss_dict: 0.0408              
VanillaPipeline.get_eval_loss_dict: 0.0326              
Trainer.eval_iteration: 0.0050              
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(
[2024-11-11 12:24:35] Completed nerfacto training
[2024-11-11 12:24:35] Starting in2n training conversion...
[12:24:42] Using --data alias for --data.pipeline.datamanager.data                                          train.py:230
──────────────────────────────────────────────────────── Config ────────────────────────────────────────────────────────
InstructNeRF2NeRFTrainerConfig(
    _target=<class 'in2n.in2n_trainer.InstructNeRF2NeRFTrainer'>,
    output_dir=PosixPath('outputs'),
    method_name='in2n',
    experiment_name=None,
    project_name='nerfstudio-project',
    timestamp='2024-11-11_122442',
    machine=MachineConfig(seed=42, num_devices=1, num_machines=1, machine_rank=0, dist_url='auto', device_type='cuda'),
    logging=LoggingConfig(
        relative_log_dir=PosixPath('.'),
        steps_per_log=1000,
        max_buffer_size=20,
        local_writer=LocalWriterConfig(
            _target=<class 'nerfstudio.utils.writer.LocalWriter'>,
            enable=True,
            stats_to_track=(
                <EventName.ITER_TRAIN_TIME: 'Train Iter (time)'>,
                <EventName.TRAIN_RAYS_PER_SEC: 'Train Rays / Sec'>,
                <EventName.CURR_TEST_PSNR: 'Test PSNR'>,
                <EventName.VIS_RAYS_PER_SEC: 'Vis Rays / Sec'>,
                <EventName.TEST_RAYS_PER_SEC: 'Test Rays / Sec'>,
                <EventName.ETA: 'ETA (time)'>
            ),
            max_log_size=10
        ),
        profiler='basic'
    ),
    viewer=ViewerConfig(
        relative_log_filename='viewer_log_filename.txt',
        websocket_port=None,
        websocket_port_default=7007,
        websocket_host='0.0.0.0',
        num_rays_per_chunk=32768,
        max_num_display_images=512,
        quit_on_train_completion=False,
        image_format='jpeg',
        jpeg_quality=75,
        make_share_url=False,
        camera_frustum_scale=0.1,
        default_composite_depth=True
    ),
    pipeline=InstructNeRF2NeRFPipelineConfig(
        _target=<class 'in2n.in2n_pipeline.InstructNeRF2NeRFPipeline'>,
        datamanager=InstructNeRF2NeRFDataManagerConfig(
            _target=<class 'in2n.in2n_datamanager.InstructNeRF2NeRFDataManager'>,
            data=PosixPath('datasets/bear'),
            masks_on_gpu=False,
            images_on_gpu=False,
            dataparser=NerfstudioDataParserConfig(
                _target=<class 'nerfstudio.data.dataparsers.nerfstudio_dataparser.Nerfstudio'>,
                data=PosixPath('.'),
                scale_factor=1.0,
                downscale_factor=None,
                scene_scale=1.0,
                orientation_method='up',
                center_method='poses',
                auto_scale_poses=True,
                eval_mode='fraction',
                train_split_fraction=0.9,
                eval_interval=8,
                depth_unit_scale_factor=0.001,
                mask_color=None,
                load_3D_points=False
            ),
            train_num_rays_per_batch=16384,
            train_num_images_to_sample_from=-1,
            train_num_times_to_repeat_images=-1,
            eval_num_rays_per_batch=4096,
            eval_num_images_to_sample_from=-1,
            eval_num_times_to_repeat_images=-1,
            eval_image_indices=(0,),
            collate_fn=<function nerfstudio_collate at 0x7f65be43df70>,
            camera_res_scale_factor=1.0,
            patch_size=32,
            camera_optimizer=None,
            pixel_sampler=PixelSamplerConfig(
                _target=<class 'nerfstudio.data.pixel_samplers.PixelSampler'>,
                num_rays_per_batch=4096,
                keep_full_image=False,
                is_equirectangular=False,
                ignore_mask=False,
                fisheye_crop_radius=None,
                rejection_sample_mask=True,
                max_num_iterations=100
            )
        ),
        model=InstructNeRF2NeRFModelConfig(
            _target=<class 'in2n.in2n.InstructNeRF2NeRFModel'>,
            enable_collider=True,
            collider_params={'near_plane': 2.0, 'far_plane': 6.0},
            loss_coefficients={'rgb_loss_coarse': 1.0, 'rgb_loss_fine': 1.0},
            eval_num_rays_per_chunk=32768,
            prompt=None,
            near_plane=0.05,
            far_plane=1000.0,
            background_color='last_sample',
            hidden_dim=64,
            hidden_dim_color=64,
            hidden_dim_transient=64,
            num_levels=16,
            base_res=16,
            max_res=2048,
            log2_hashmap_size=19,
            features_per_level=2,
            num_proposal_samples_per_ray=(256, 96),
            num_nerf_samples_per_ray=48,
            proposal_update_every=5,
            proposal_warmup=5000,
            num_proposal_iterations=2,
            use_same_proposal_network=False,
            proposal_net_args_list=[
                {'hidden_dim': 16, 'log2_hashmap_size': 17, 'num_levels': 5, 'max_res': 128, 'use_linear': False},
                {'hidden_dim': 16, 'log2_hashmap_size': 17, 'num_levels': 5, 'max_res': 256, 'use_linear': False}
            ],
            proposal_initial_sampler='piecewise',
            interlevel_loss_mult=1.0,
            distortion_loss_mult=0.002,
            orientation_loss_mult=0.0001,
            pred_normal_loss_mult=0.001,
            use_proposal_weight_anneal=True,
            use_appearance_embedding=True,
            use_average_appearance_embedding=True,
            proposal_weights_anneal_slope=10.0,
            proposal_weights_anneal_max_num_iters=1000,
            use_single_jitter=True,
            predict_normals=False,
            disable_scene_contraction=False,
            use_gradient_scaling=False,
            implementation='tcnn',
            appearance_embed_dim=32,
            average_init_density=1.0,
            camera_optimizer=CameraOptimizerConfig(
                _target=<class 'nerfstudio.cameras.camera_optimizers.CameraOptimizer'>,
                mode='SO3xR3',
                trans_l2_penalty=0.01,
                rot_l2_penalty=0.001,
                optimizer=None,
                scheduler=None
            ),
            use_lpips=True,
            use_l1=True,
            patch_size=32,
            lpips_loss_mult=1.0
        ),
        prompt='Change the bear to a white dog',
        guidance_scale=7.5,
        image_guidance_scale=1.5,
        edit_rate=10,
        edit_count=1,
        diffusion_steps=20,
        lower_bound=0.02,
        upper_bound=0.98,
        ip2p_device=None,
        ip2p_use_full_precision=True,
        save_edited_images=False,
        output_dir=None
    ),
    optimizers={
        'proposal_networks': {
            'optimizer': AdamOptimizerConfig(
                _target=<class 'torch.optim.adam.Adam'>,
                lr=0.01,
                eps=1e-15,
                max_norm=None,
                weight_decay=0
            ),
            'scheduler': ExponentialDecaySchedulerConfig(
                _target=<class 'nerfstudio.engine.schedulers.ExponentialDecayScheduler'>,
                lr_pre_warmup=1e-08,
                lr_final=0.0001,
                warmup_steps=0,
                max_steps=200000,
                ramp='cosine'
            )
        },
        'fields': {
            'optimizer': AdamOptimizerConfig(
                _target=<class 'torch.optim.adam.Adam'>,
                lr=0.01,
                eps=1e-15,
                max_norm=None,
                weight_decay=0
            ),
            'scheduler': ExponentialDecaySchedulerConfig(
                _target=<class 'nerfstudio.engine.schedulers.ExponentialDecayScheduler'>,
                lr_pre_warmup=1e-08,
                lr_final=0.0001,
                warmup_steps=0,
                max_steps=200000,
                ramp='cosine'
            )
        },
        'camera_opt': {
            'optimizer': AdamOptimizerConfig(
                _target=<class 'torch.optim.adam.Adam'>,
                lr=0.0006,
                eps=1e-08,
                max_norm=None,
                weight_decay=0.01
            ),
            'scheduler': ExponentialDecaySchedulerConfig(
                _target=<class 'nerfstudio.engine.schedulers.ExponentialDecayScheduler'>,
                lr_pre_warmup=1e-08,
                lr_final=6e-06,
                warmup_steps=0,
                max_steps=5000,
                ramp='cosine'
            )
        }
    },
    vis='tensorboard',
    data=PosixPath('datasets/bear'),
    prompt=None,
    relative_model_dir=PosixPath('nerfstudio_models'),
    load_scheduler=True,
    steps_per_save=250,
    steps_per_eval_batch=1000,
    steps_per_eval_image=100,
    steps_per_eval_all_images=25000,
    max_num_iterations=15000,
    mixed_precision=True,
    use_grad_scaler=False,
    save_only_latest_checkpoint=True,
    load_dir=PosixPath('outputs/bear/nerfacto/2024-11-11_115159/nerfstudio_models'),
    load_step=None,
    load_config=None,
    load_checkpoint=None,
    log_gradients=False,
    gradient_accumulation_steps={}
)
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
           Saving config to: outputs/bear/in2n/2024-11-11_122442/config.yml                     experiment_config.py:136
[12:24:43] Saving checkpoints to: outputs/bear/in2n/2024-11-11_122442/nerfstudio_models                   trainer.py:138
           Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 87 images.

Setting up evaluation dataset...
Caching all 9 images.

tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
tiny-cuda-nn warning: FullyFusedMLP is not supported for the selected architecture 61. Falling back to CutlassMLP. For maximum performance, raise the target GPU architecture to 75+.
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/tinycudann/modules.py:57: UserWarning: tinycudann was built for lower compute capability (61) than the system's (86). Performance may be suboptimal.
  warnings.warn(f"tinycudann was built for lower compute capability ({cc}) than the system's ({system_compute_capability}). Performance may be suboptimal.")
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/nerfstudio/field_components/activations.py:32: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  @custom_fwd(cast_inputs=torch.float32)
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/nerfstudio/field_components/activations.py:39: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, g):
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/nerfstudio/engine/trainer.py:133: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.grad_scaler = GradScaler(enabled=self.use_grad_scaler)
/home/pljh0906/anaconda3/envs/nerfstudio/lib/python3.8/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  17%|█▋        | 1/6 [00:02<00:10,  2.05s/it]Loading pipeline components...:  33%|███▎      | 2/6 [00:02<00:03,  1.10it/s]Loading pipeline components...:  50%|█████     | 3/6 [00:04<00:04,  1.58s/it]Loading pipeline components...:  67%|██████▋   | 4/6 [00:15<00:10,  5.14s/it]Loading pipeline components...:  83%|████████▎ | 5/6 [00:15<00:03,  3.45s/it]Loading pipeline components...: 100%|██████████| 6/6 [00:15<00:00,  2.60s/it]InstructPix2Pix loaded!
Loading latest Nerfstudio checkpoint from load_dir...
Done loading Nerfstudio checkpoint from outputs/bear/nerfacto/2024-11-11_115159/nerfstudio_models/step-000029999.ckpt
logging events to: outputs/bear/in2n/2024-11-11_122442
[12:25:28] Printing max of 10 lines. Set flag --logging.local-writer.max-log-size=0 to disable line        writer.py:449
           wrapping.                                                                                                    
Step (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec      
--------------------------------------------------------------------------------------------------------
[2A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
[3A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
[4A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
[5A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
[6A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
34000 (226.67%)     1 s, 477.637 ms      16 h, 12 m, 5 s      128.27 K             348.17 K              [0m
[7A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
34000 (226.67%)     1 s, 477.637 ms      16 h, 12 m, 5 s      128.27 K             348.17 K              [0m
35000 (233.33%)     1 s, 473.122 ms      15 h, 48 m, 58 s     127.68 K             348.78 K              [0m
[8A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
34000 (226.67%)     1 s, 477.637 ms      16 h, 12 m, 5 s      128.27 K             348.17 K              [0m
35000 (233.33%)     1 s, 473.122 ms      15 h, 48 m, 58 s     127.68 K             348.78 K              [0m
36000 (240.00%)     1 s, 476.567 ms      15 h, 23 m, 13 s     127.79 K             348.97 K              [0m
[9A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
34000 (226.67%)     1 s, 477.637 ms      16 h, 12 m, 5 s      128.27 K             348.17 K              [0m
35000 (233.33%)     1 s, 473.122 ms      15 h, 48 m, 58 s     127.68 K             348.78 K              [0m
36000 (240.00%)     1 s, 476.567 ms      15 h, 23 m, 13 s     127.79 K             348.97 K              [0m
37000 (246.67%)     1 s, 473.985 ms      14 h, 59 m, 33 s     128.59 K             349.34 K              [0m
[10A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
34000 (226.67%)     1 s, 477.637 ms      16 h, 12 m, 5 s      128.27 K             348.17 K              [0m
35000 (233.33%)     1 s, 473.122 ms      15 h, 48 m, 58 s     127.68 K             348.78 K              [0m
36000 (240.00%)     1 s, 476.567 ms      15 h, 23 m, 13 s     127.79 K             348.97 K              [0m
37000 (246.67%)     1 s, 473.985 ms      14 h, 59 m, 33 s     128.59 K             349.34 K              [0m
38000 (253.33%)     1 s, 473.250 ms      14 h, 35 m, 16 s     126.72 K             348.50 K              [0m
[11A[1KStep (% Done)       Train Iter (time)    ETA (time)           Train Rays / Sec     Test Rays / Sec       [0m
-------------------------------------------------------------------------------------------------------- [0m
30000 (200.00%)     17 s, 686.989 ms     22 h, 18 m, 16 s     926.33               327.50 K              [0m
31000 (206.67%)     1 s, 496.727 ms      17 h, 20 m, 53 s     120.57 K             341.34 K              [0m
32000 (213.33%)     1 s, 482.325 ms      17 h, 0 m, 1 s       126.94 K             345.37 K              [0m
33000 (220.00%)     1 s, 486.963 ms      16 h, 33 m, 55 s     128.07 K             347.87 K              [0m
34000 (226.67%)     1 s, 477.637 ms      16 h, 12 m, 5 s      128.27 K             348.17 K              [0m
35000 (233.33%)     1 s, 473.122 ms      15 h, 48 m, 58 s     127.68 K             348.78 K              [0m
slurmstepd-node30: error: *** JOB 172089 ON node30 CANCELLED AT 2024-11-11T17:28:27 DUE TO PREEMPTION ***
